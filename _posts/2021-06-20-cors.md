---
layout: single
title: 'CORS란?'
---




# 동일 출처 정책(SOP: Same-Origin policy)
SOP는 다른 출처의 리소스를 사용하는 것을 제한하는 보안 방식이다.

## 출처(Origin)란?

URL 의 프로토콜 호스트 포트를 통해 같은 출처인지 다른 출처인지 판단할 수 있다.

즉 프로토콜, 호스트, 포트 중 하나라도 다르면 다른 출처라고 판단하며 이 세가지가 같아야지만 같은 출처라고 한다.


### 동일 출처 예시
---
>http://example.com/app1/index.html <br> http://example.com/app2/index.html<br>

> http://Example.com:80 <br>
http://example.com 

프로토콜, 도메인, 포트가 모두 일치한다. HTTP의 기본 포트는 80이기 때문에 생략해도 동일 출처


### 다른 출처 예시

**다른 프로토콜**
>http://example.com/app1<br>
https://example.com/app2

**다른 호스트**
>http://example.com<br>
http://www.example.com<br>
http://myapp.example.com

**다른포트**
>http://example.com<br>
http://example.com:8080




## SOP를 왜 사용할까?
만약 서로 다른 출처의 애플리케이션이 아무런 제약없이 리소스를 공유하는 것은 위험할 수 있다. 예를 들어 악성 웹 사이트가 브라우저에서 자바스크립트를 실행하여 우리의 애플리케이션에서 코드가 정상적으로 실행된 것처럼 꾸며 사용자의 정보를 탈취할 수도 있다.

하지만 웹에서 다른 출처의 리소스를 가져와 사용하는 일은 흔히 일어나는 일이다. 그레서 CORS를 사용해 서로 다른 출처의 접근을 허용하도록 할 수 있다.

# 교차 출처 리소스 공유(CORS: Croos-Origin Resource Sharing)

CORS는 HTTP 헤더를 사용하여, 한 출처에서 실행 중인 웹 애플리케이션이 다른 출처의 리소스에 접근할 수 있는 권한을 부여하도록 브라우저에 알려주는 체제이다.

웹 애플리케이션은 교차 출처 HTTP 요청을 제한하기 때문에 다른 출처의 리소스를 불러오려면 그 출처에서 올바른 CORS 헤더를 포함한 응답을 반환해야 한다.

## CORS의 동작
CORS는 웹 브라우저에서 정보를 읽는 것이 허용된 출처를 서버에 HTTP 헤더를 추가함으로써 동작한다.

웹 클라이언트 애플리케이션이 다른 출처의 리소스를 요청할 때 HTTP 프로토콜을 사용하여 보내고 브라우저는 요청 헤더에 Origin이라는 필드에 출처를 담아 보낸다.

이후 서버가 응답 헤더에 Access-Control-Allow-Origin 이라는 값에 접근을 허용하는 출처를 담아 보내주고, 브라우저는 Origin과 Access-Control-Allow-Origin을 비교 후 유효한 지를 결정한다.

### **프리플라이트 요청(Preflight Request)**
프리플라이트 요청은 브라우저가 본 요청을 보내기 전에 사전 요청을 보내는 것으로 HTTP 요청을 보낼 때 OPTIONS 메소드를 사용한다.